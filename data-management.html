<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Data Management — Cek Kesehatan</title>
  <link rel="stylesheet" href="/frontend/css/style.css">
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { 
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Inter', sans-serif; 
      background: #f5f7fa; 
      padding: 0; 
      min-height: 100vh; 
    }
    
    /* Top Bar */
    .top-bar {
      background: linear-gradient(135deg, #1c84c6 0%, #1670a8 100%);
      border-bottom: none;
      padding: 16px 32px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      position: sticky;
      top: 0;
      z-index: 100;
      box-shadow: 0 2px 8px rgba(28,132,198,0.2);
    }
    
    .top-bar-left {
      display: flex;
      align-items: center;
      gap: 24px;
    }
    
    .top-bar h1 { 
      margin: 0; 
      font-size: 20px; 
      font-weight: 600; 
      color: white;
      letter-spacing: -0.3px;
    }
    
    .top-bar a { 
      color: rgba(255,255,255,0.9); 
      text-decoration: none; 
      font-size: 14px; 
      font-weight: 500; 
      display: inline-flex; 
      align-items: center; 
      gap: 6px; 
      transition: all 0.2s;
      padding: 6px 12px;
      border-radius: 6px;
    }
    .top-bar a:hover { 
      color: white; 
      background: rgba(255,255,255,0.15); 
    }
    
    .top-bar-right {
      display: flex;
      gap: 12px;
      align-items: center;
    }
    
    .dm-container { 
      max-width: 1800px; 
      margin: 0 auto; 
      padding: 24px 32px;
    }
    
    /* Control Bar */
    .control-bar {
      background: white;
      border-radius: 12px;
      padding: 16px 20px;
      margin-bottom: 16px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 16px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.05);
      border: 1px solid #e5e7eb;
    }
    
    .control-left {
      display: flex;
      align-items: center;
      gap: 12px;
    }
    
    .control-right {
      display: flex;
      align-items: center;
      gap: 12px;
    }
    
    .search-box {
      padding: 9px 16px 9px 38px;
      border: 1px solid #e5e7eb;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 400;
      width: 300px;
      transition: all 0.2s;
      background: #fafbfc url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="%2394a3b8" stroke-width="2"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>') no-repeat 12px center;
    }
    
    .search-box:focus {
      outline: none;
      border-color: #1c84c6;
      background-color: white;
      box-shadow: 0 0 0 3px rgba(28,132,198,0.1);
    }
    
    .search-box::placeholder {
      color: #94a3b8;
    }
    
    .records-info {
      font-size: 13px;
      font-weight: 500;
      color: #64748b;
    }
    
    .bulk-dropdown {
      position: relative;
    }
    
    .menu-btn {
      padding: 9px 16px;
      border: 1px solid rgba(255,255,255,0.3);
      border-radius: 8px;
      background: rgba(255,255,255,0.15);
      color: white;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      gap: 8px;
      position: relative;
    }
    
    .menu-btn:hover {
      background: rgba(255,255,255,0.25);
      border-color: rgba(255,255,255,0.5);
    }
    
    .menu-btn svg {
      width: 14px;
      height: 14px;
    }
    
    .dropdown-menu {
      position: absolute;
      top: calc(100% + 8px);
      right: 0;
      background: white;
      border: 1px solid #e5e7eb;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      min-width: 200px;
      display: none;
      z-index: 1000;
    }
    
    .dropdown-menu.show {
      display: block;
    }
    
    .dropdown-item {
      padding: 12px 16px;
      color: #334155;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: background 0.15s;
      display: flex;
      align-items: center;
      gap: 10px;
      border: none;
      background: none;
      width: 100%;
      text-align: left;
    }
    
    .dropdown-item:first-child {
      border-radius: 8px 8px 0 0;
    }
    
    .dropdown-item:last-child {
      border-radius: 0 0 8px 8px;
    }
    
    .dropdown-item:hover {
      background: #f8fafc;
    }
    
    .dropdown-item svg {
      width: 16px;
      height: 16px;
    }
    
    .dropdown-item.danger:hover {
      background: #fef2f2;
      color: #ef4444;
    }
    
    .btn-icon {
      padding: 9px 14px;
      border: 1px solid rgba(255,255,255,0.3);
      border-radius: 8px;
      background: rgba(255,255,255,0.15);
      color: white;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    
    .btn-icon:hover {
      background: rgba(255,255,255,0.25);
      border-color: rgba(255,255,255,0.5);
    }
    
    .btn-icon svg {
      width: 16px;
      height: 16px;
    }
    
    .dm-table-wrap { 
      background: white; 
      border-radius: 12px; 
      overflow: hidden;
      box-shadow: 0 1px 3px rgba(0,0,0,0.05);
      border: 1px solid #e5e7eb;
    }
    
    .table-scroll { 
      overflow-x: auto; 
      overflow-y: visible;
    }
    
    .dm-table { 
      width: 100%; 
      border-collapse: collapse;
    }
    .dm-table thead { 
      background: #fafbfc;
      border-bottom: 2px solid #e5e7eb;
    }
    
    .dm-table th { 
      padding: 14px 16px; 
      text-align: center; 
      font-weight: 600; 
      color: #64748b; 
      text-transform: uppercase; 
      font-size: 11px;
      letter-spacing: 0.5px;
      white-space: nowrap;
      position: sticky;
      top: 0;
      z-index: 10;
      background: #fafbfc;
    }
    
    .dm-table th.freeze-check,
    .dm-table th.freeze-name {
      text-align: left;
    }
    
    .dm-table th.freeze-check {
      position: sticky;
      left: 0;
      z-index: 12;
      background: #fafbfc;
    }
    
    .dm-table th.freeze-name {
      position: sticky;
      left: 60px;
      z-index: 12;
      background: #fafbfc;
      box-shadow: 2px 0 6px rgba(0,0,0,0.08);
    }
    
    .dm-table tbody tr { 
      border-bottom: 1px solid #f1f5f9; 
      transition: all 0.15s;
    }
    
    .dm-table tbody tr:hover { 
      background: #f8fafc;
    }
    
    .dm-table tbody tr:last-child { 
      border-bottom: none; 
    }
    
    .dm-table td { 
      padding: 14px 16px; 
      color: #334155; 
      font-size: 14px;
      font-weight: 400;
      white-space: nowrap;
      max-width: 200px;
      overflow: hidden;
      text-overflow: ellipsis;
      text-align: center;
    }
    
    .dm-table td.freeze-check,
    .dm-table td.freeze-name {
      text-align: left;
    }
    
    .dm-table td.freeze-check {
      position: sticky;
      left: 0;
      z-index: 10;
      background: white;
    }
    
    .dm-table td.freeze-name {
      position: sticky;
      left: 60px;
      z-index: 10;
      background: white;
      max-width: 180px;
      font-weight: 500;
      color: #1e293b;
      box-shadow: 2px 0 6px rgba(0,0,0,0.08);
    }
    
    .dm-table tbody tr:hover td.freeze-check,
    .dm-table tbody tr:hover td.freeze-name {
      background: #f8fafc;
    }
    
    .dm-table td.full-width {
      max-width: none;
    }
    
    .dm-table .checkbox-col { 
      width: 60px; 
      text-align: center;
    }
    .dm-table .checkbox-col input[type="checkbox"] { 
      width: 18px; 
      height: 18px; 
      cursor: pointer;
      accent-color: #3b82f6;
    }
    
    .dm-table .actions-col { 
      width: 120px; 
      text-align: center; 
      white-space: nowrap;
    }
    
    .dm-table .actions-col button { 
      padding: 6px 10px; 
      margin: 0 3px; 
      border: none; 
      border-radius: 6px; 
      font-size: 16px; 
      cursor: pointer;
      transition: all 0.15s;
      background: transparent;
      color: #64748b;
    }
    
    .dm-table .btn-edit:hover { 
      background: #eff6ff; 
      color: #3b82f6;
    }
    
    .dm-table .btn-delete:hover { 
      background: #fef2f2; 
      color: #ef4444;
    }
    
    .no-data { 
      padding: 60px; 
      text-align: center; 
      color: #94a3b8; 
      font-size: 14px;
      font-weight: 400;
    }
    
    .empty-state {
      padding: 80px 40px;
      text-align: center;
    }
    
    .empty-state-icon {
      font-size: 48px;
      margin-bottom: 16px;
      opacity: 0.5;
    }
    
    .empty-state-text {
      font-size: 15px;
      color: #64748b;
      font-weight: 500;
      margin-bottom: 8px;
    }
    
    .empty-state-subtext {
      font-size: 13px;
      color: #94a3b8;
    }
    
    /* Custom Alert Modal */
    .alert-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(15,23,42,0.5);
      z-index: 2000;
      backdrop-filter: blur(4px);
      align-items: center;
      justify-content: center;
    }
    
    .alert-modal.show {
      display: flex;
    }
    
    .alert-content {
      background: white;
      border-radius: 12px;
      padding: 28px;
      max-width: 420px;
      width: calc(100% - 40px);
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
      animation: alertSlideIn 0.2s ease-out;
    }
    
    @keyframes alertSlideIn {
      from {
        opacity: 0;
        transform: translateY(-20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    .alert-icon {
      width: 56px;
      height: 56px;
      margin: 0 auto 20px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .alert-icon.success {
      background: #d1fae5;
    }
    
    .alert-icon.warning {
      background: #fef3c7;
    }
    
    .alert-icon.danger {
      background: #fee2e2;
    }
    
    .alert-icon svg {
      width: 28px;
      height: 28px;
    }
    
    .alert-icon.success svg {
      stroke: #10b981;
    }
    
    .alert-icon.warning svg {
      stroke: #f59e0b;
    }
    
    .alert-icon.danger svg {
      stroke: #ef4444;
    }
    
    .alert-title {
      font-size: 18px;
      font-weight: 600;
      color: #1e293b;
      text-align: center;
      margin-bottom: 8px;
    }
    
    .alert-message {
      font-size: 14px;
      color: #64748b;
      text-align: center;
      line-height: 1.6;
      margin-bottom: 24px;
    }
    
    .alert-actions {
      display: flex;
      gap: 10px;
    }
    
    .alert-btn {
      flex: 1;
      padding: 11px;
      border: none;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.15s;
    }
    
    .alert-btn-primary {
      background: #1c84c6;
      color: white;
    }
    
    .alert-btn-primary:hover {
      background: #1670a8;
    }
    
    .alert-btn-secondary {
      background: white;
      color: #64748b;
      border: 1px solid #e5e7eb;
    }
    
    .alert-btn-secondary:hover {
      background: #f8fafc;
    }
    
    .alert-btn-danger {
      background: #ef4444;
      color: white;
    }
    
    .alert-btn-danger:hover {
      background: #dc2626;
    }
    
    /* Edit Modal */
    .modal { 
      display: none; 
      position: fixed; 
      top: 0; 
      left: 0; 
      right: 0; 
      bottom: 0; 
      background: rgba(15,23,42,0.5); 
      z-index: 1000;
      backdrop-filter: blur(4px);
    }
    .modal.active { 
      display: flex; 
      align-items: center; 
      justify-content: center; 
      padding: 20px; 
    }
    .modal-content { 
      background: white; 
      border-radius: 12px; 
      padding: 32px; 
      max-width: 600px; 
      width: 100%; 
      max-height: 90vh; 
      overflow-y: auto;
      box-shadow: 0 20px 60px rgba(0,0,0,0.2);
    }
    .modal-content h2 { 
      margin: 0 0 24px 0; 
      font-size: 20px; 
      font-weight: 600; 
      color: #1e293b;
      letter-spacing: -0.3px;
    }
    .modal-content label { 
      display: block; 
      margin-bottom: 16px; 
    }
    .modal-content label span { 
      display: block; 
      margin-bottom: 6px; 
      font-size: 13px; 
      font-weight: 500; 
      color: #475569;
    }
    .modal-content label input,
    .modal-content label select { 
      width: 100%; 
      padding: 10px 12px; 
      border: 1px solid #e5e7eb; 
      border-radius: 8px; 
      font-size: 14px;
      font-weight: 400;
      transition: all 0.2s;
      background: white;
    }
    .modal-content label input:focus,
    .modal-content label select:focus { 
      outline: none; 
      border-color: #3b82f6; 
      box-shadow: 0 0 0 3px rgba(59,130,246,0.08);
    }
    .modal-content label select {
      cursor: pointer;
    }
    .modal-actions { 
      display: flex; 
      gap: 12px; 
      margin-top: 24px; 
      padding-top: 24px;
      border-top: 1px solid #f1f5f9;
    }
    .modal-actions button { 
      flex: 1; 
      padding: 11px; 
      border: none; 
      border-radius: 8px; 
      cursor: pointer; 
      font-size: 14px; 
      font-weight: 500;
      transition: all 0.15s;
    }
    .modal-actions .btn-danger {
      background: white;
      color: #64748b;
      border: 1px solid #e5e7eb;
    }
    .modal-actions .btn-danger:hover {
      background: #f8fafc;
      border-color: #cbd5e1;
    }
    .modal-actions .btn-success {
      background: #3b82f6;
      color: white;
    }
    .modal-actions .btn-success:hover {
      background: #2563eb;
    }
    
    /* Pagination */
    .pagination {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 16px 20px;
      border-top: 1px solid #f1f5f9;
      background: #fafbfc;
    }
    
    .pagination-info {
      font-size: 13px;
      color: #64748b;
    }
    
    .pagination-controls {
      display: flex;
      gap: 8px;
    }
    
    .pagination-controls button {
      padding: 8px 14px;
      border: 1px solid #e5e7eb;
      border-radius: 6px;
      background: white;
      color: #475569;
      font-size: 13px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.15s;
    }
    
    .pagination-controls button:hover:not(:disabled) {
      background: #f8fafc;
      border-color: #3b82f6;
      color: #3b82f6;
    }
    
    .pagination-controls button:disabled {
      opacity: 0.4;
      cursor: not-allowed;
    }
    
    .pagination-controls button.active {
      background: #3b82f6;
      color: white;
      border-color: #3b82f6;
    }
    
    /* Responsive */
    @media (max-width: 1200px) {
      .control-bar { flex-direction: column; align-items: stretch; }
      .control-left, .control-right { width: 100%; justify-content: space-between; }
      .search-box { width: 100%; }
    }
    
    @media (max-width: 768px) {
      .dm-container { padding: 16px; }
      .top-bar { padding: 12px 16px; }
      .top-bar h1 { font-size: 18px; }
      .control-bar { padding: 12px; }
      .dm-table th, .dm-table td { padding: 10px 12px; font-size: 13px; }
      .modal-content { padding: 24px; }
    }
  </style>
</head>
<body>
  <!-- Top Bar -->
  <div class="top-bar">
    <div class="top-bar-left">
      <h1>Data Management</h1>
      <a href="/admin" id="backToAdmin">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m15 18-6-6 6-6"/></svg>
        Kembali
      </a>
    </div>
    <div class="top-bar-right">
      <button class="btn-icon" id="downloadSelected" title="Download Data Terpilih">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
        Download
      </button>
      <div class="bulk-dropdown">
        <button class="menu-btn" id="menuBtn">
          <span>Menu</span>
          <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"/></svg>
        </button>
        <div class="dropdown-menu" id="dropdownMenu">
          <button class="dropdown-item" id="downloadAllBtn">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
            Download Semua Data
          </button>
          <button class="dropdown-item danger" id="deleteAllBtn">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/></svg>
            Hapus Semua Data
          </button>
        </div>
      </div>
    </div>
  </div>

  <div class="dm-container">
    <!-- Control Bar -->
    <div class="control-bar">
      <div class="control-left">
        <span class="records-info" id="recordsCount">0 data tersimpan</span>
      </div>
      <div class="control-right">
        <input type="text" class="search-box" id="searchBox" placeholder="Cari nama, umur, telepon...">
      </div>
    </div>

    <!-- Table -->
    <div class="dm-table-wrap">
      <div class="table-scroll">
        <table class="dm-table">
          <thead>
            <tr>
              <th class="checkbox-col freeze freeze-check"><input type="checkbox" id="selectAll"></th>
              <th class="freeze freeze-name">Nama</th>
              <th>Umur</th>
              <th>Gender</th>
              <th>No. Telp</th>
              <th>Timestamp</th>
              <th>Height</th>
              <th>Sit & Reach</th>
              <th>Heart Rate</th>
              <th>Kalori</th>
              <th>Body Age</th>
              <th>Push Up</th>
              <th>Leg & Back</th>
              <th>Handgrip</th>
              <th class="actions-col">Actions</th>
            </tr>
          </thead>
          <tbody id="recordsBody">
            <tr><td colspan="15" class="no-data">Memuat data...</td></tr>
          </tbody>
        </table>
      </div>
      
      <!-- Pagination -->
      <div class="pagination" id="paginationBar" style="display:none;">
        <div class="pagination-info" id="paginationInfo">Showing 1-10 of 50</div>
        <div class="pagination-controls" id="paginationControls">
          <button id="prevPage">← Prev</button>
          <button class="active">1</button>
          <button>2</button>
          <button>3</button>
          <button id="nextPage">Next →</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Custom Alert Modal -->
  <div class="alert-modal" id="alertModal">
    <div class="alert-content">
      <div class="alert-icon" id="alertIcon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
          <polyline points="22 4 12 14.01 9 11.01"/>
        </svg>
      </div>
      <div class="alert-title" id="alertTitle">Berhasil</div>
      <div class="alert-message" id="alertMessage">Operasi berhasil dilakukan</div>
      <div class="alert-actions" id="alertActions">
        <button class="alert-btn alert-btn-primary" onclick="closeAlert()">OK</button>
      </div>
    </div>
  </div>

  <!-- Edit Modal -->
  <div class="modal" id="editModal">
    <div class="modal-content">
      <h2>Edit Data Peserta</h2>
      <form id="editForm">
        <input type="hidden" id="editId">
        <label><span>Nama</span><input type="text" id="editName" required minlength="2" maxlength="200"></label>
        <label><span>Umur</span><input type="number" id="editAge" required min="1" max="150"></label>
        <label><span>No. Telp</span><input type="text" id="editPhone" required pattern="[0-9+\-\s()]+" title="Hanya angka, +, -, (, ), dan spasi"></label>
        <label><span>Jenis Kelamin</span>
          <select id="editGender" required style="padding:14px 16px;border:2px solid #e5e7eb;border-radius:10px;font-size:16px;font-weight:500;transition:border 0.2s;">
            <option value="">-- Pilih Jenis Kelamin --</option>
            <option value="Laki-laki">Laki-laki</option>
            <option value="Perempuan">Perempuan</option>
          </select>
        </label>
        <label><span>Height (cm)</span><input type="number" id="editHeight" required min="0" max="300" step="0.1"></label>
        <label><span>Sit & Reach (cm)</span><input type="number" id="editSit" required min="-50" max="100" step="0.1"></label>
        <label><span>Heart Rate (bpm)</span><input type="number" id="editHr" required min="0" max="300"></label>
        <label><span>Kalori (kcal)</span><input type="number" id="editCal" required min="0" max="10000"></label>
        <label><span>Body Age</span><input type="number" id="editBodyAge" required min="0" max="150"></label>
        <label><span>Push Up</span><input type="number" id="editPush" required min="0" max="1000"></label>
        <label><span>Leg & Back (kg)</span><input type="number" id="editLeg" required min="0" max="500" step="0.1"></label>
        <label><span>Handgrip (kg)</span><input type="number" id="editHandgrip" required min="0" max="200" step="0.1"></label>
        <div class="modal-actions">
          <button type="button" class="btn-danger" id="cancelEdit">Batal</button>
          <button type="submit" class="btn-success">Simpan Perubahan</button>
        </div>
      </form>
    </div>
  </div>

  <script src="/frontend/js/data-management.js"></script>
</body>
</html>
